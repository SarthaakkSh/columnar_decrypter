<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Columnar Transposition Decryptor</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; }
    h1 { font-size: 1.4rem; }
    label { display:block; margin-top: 12px; font-weight: bold; }
    textarea, input { width: 100%; padding: 8px; font-size: 1rem; box-sizing: border-box; }
    button { margin-top: 12px; padding: 10px 16px; font-size: 1rem; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 6px; margin-top: 12px; }
  </style>
</head>
<body>
  <h1>Columnar Transposition Cipher â€” Decrypt</h1>

  <label for="cipher">Ciphertext</label>
  <textarea id="cipher" rows="5" placeholder="Paste ciphertext here"></textarea>

  <label for="keyword">Keyword</label>
  <input id="keyword" type="text" placeholder="Enter keyword" />

  <button id="decrypt">Decrypt</button>

  <h2>Plaintext</h2>
  <pre id="output">(not decrypted yet)</pre>

  <script>
    function keywordOrder(keyword) {
      const arr = Array.from(keyword).map((ch, i) => ({ch, i}));
      const sorted = arr.slice().sort((a,b) => {
        const A = a.ch.toUpperCase(), B = b.ch.toUpperCase();
        if (A < B) return -1; if (A > B) return 1; return a.i - b.i;
      });
      const order = new Array(keyword.length);
      sorted.forEach((item, rank) => { order[item.i] = rank; });
      return order;
    }

    function decrypt(ciphertext, keyword) {
      const cols = keyword.length;
      const rows = Math.ceil(ciphertext.length / cols);
      const order = keywordOrder(keyword);
      const matrix = Array.from({length: rows}, () => new Array(cols).fill(''));

      let k = 0;
      const colIndices = [...Array(cols).keys()].sort((a,b) => order[a] - order[b]);
      for (const col of colIndices) {
        for (let r = 0; r < rows; r++) {
          if (k < ciphertext.length) {
            matrix[r][col] = ciphertext[k++];
          }
        }
      }

      let plaintext = '';
      for (let r = 0; r < rows; r++) {
        plaintext += matrix[r].join('');
      }

      // Remove padding X
      return plaintext.replace(/X+$/i, '');
    }

    document.getElementById('decrypt').addEventListener('click', () => {
      const cipher = document.getElementById('cipher').value.trim();
      const keyword = document.getElementById('keyword').value.trim();
      if (!cipher || !keyword) {
        alert("Please provide both ciphertext and keyword");
        return;
      }
      const plain = decrypt(cipher, keyword);
      document.getElementById('output').textContent = plain || "(empty)";
    });
  </script>
</body>
</html>
